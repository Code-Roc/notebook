<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link rel="stylesheet" href="assets/css/style.css?20170509">
    <title>notebook by zjuchenyuan</title>
  </head>

  <body>

    <header>
      <div class="container">
        <h1>notebook</h1>
        <h2>我的技术笔记本~</h2>

        <section id="downloads">
          
          <a href="https://github.com/zjuchenyuan/notebook/blob/master/gist.md" class="btn btn-github"><span class="icon"></span>Star me on GitHub (58)</a>&nbsp;<a href="https://py3.io" class="btn btn-back"><span class="icon"></span>Back to Index</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <h1 id="gist-">gist 记录一些代码片段</h1>

<h2 id="pythonmysql">python连接mysql插入、查询</h2>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pymysql</span>
<span class="k">def</span> <span class="nf">db</span><span class="p">():</span>
    <span class="n">conn</span> <span class="o">=</span> <span class="n">pymysql</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="s">'root'</span><span class="p">,</span><span class="n">passwd</span><span class="o">=</span><span class="s">'123456'</span><span class="p">,</span><span class="n">host</span><span class="o">=</span><span class="s">'localhost'</span><span class="p">,</span><span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span><span class="n">db</span><span class="o">=</span><span class="s">'dbname'</span><span class="p">,</span><span class="n">charset</span><span class="o">=</span><span class="s">'utf8'</span><span class="p">,</span><span class="n">init_command</span><span class="o">=</span><span class="s">"set NAMES utf8mb4"</span><span class="p">,</span> <span class="n">use_unicode</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">conn</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="s">"utf8"</span>
    <span class="k">return</span> <span class="n">conn</span>
<span class="n">conn</span><span class="o">=</span><span class="n">db</span><span class="p">()</span>
<span class="n">cur</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="c"># 增</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="o">...</span><span class="p">:</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s">"insert into tablename values("</span><span class="o">+</span><span class="nb">repr</span><span class="p">(</span><span class="n">item</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s">")"</span><span class="p">)</span>
    <span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<span class="c"># 查一条，返回一个dict</span>
<span class="nb">id</span> <span class="o">=</span> <span class="o">...</span> <span class="c">#id为主键 只会有一条记录</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s">"select * from tablename where id="</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">))</span>
<span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">((</span><span class="s">"id"</span><span class="p">,</span><span class="s">"flag"</span><span class="p">,</span><span class="s">"更多的列名"</span><span class="p">),</span><span class="nb">list</span><span class="p">(</span><span class="n">cur</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
</code></pre>
</div>

<h2 id="flask">flask设置一堆静态目录</h2>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">Blueprint</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">Markup</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="p">[</span><span class="s">'pic'</span><span class="p">,</span> <span class="s">'skin'</span><span class="p">,</span> <span class="s">'images'</span><span class="p">,</span> <span class="s">'更多静态目录'</span><span class="p">]:</span>
    <span class="n">blueprint</span> <span class="o">=</span> <span class="n">Blueprint</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">__name__</span><span class="p">,</span> <span class="n">static_url_path</span><span class="o">=</span><span class="s">'/'</span><span class="o">+</span><span class="n">path</span><span class="p">,</span> <span class="n">static_folder</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">register_blueprint</span><span class="p">(</span><span class="n">blueprint</span><span class="p">)</span>
</code></pre>
</div>

<h2 id="python">python大小写不敏感字典</h2>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">requests.structures</span> <span class="kn">import</span> <span class="n">CaseInsensitiveDict</span>
<span class="n">mydict</span> <span class="o">=</span> <span class="n">CaseInsensitiveDict</span><span class="p">(</span><span class="n">mydict</span><span class="p">)</span>
</code></pre>
</div>

      </section>
<br><hr><h1 id="comment">评论区</h1><div id="comment-thread"></div><div id="loading-spin"></div>
    </div>

  </body>
<script src="assets/js/instantclick.min.js" data-no-instant></script>
<link rel="stylesheet" href="assets/css/comment.css">
<script src="assets/js/comment.js" data-no-instant></script>
<script>
  marked.setOptions({
  highlight: function (code, lang) {
     return hljs.highlightAuto(code).value;
  }
  });
  function Highlighting(){
    var markdowns = document.getElementsByClassName('markdown');
    for(var i=0;i<markdowns.length;i++){
       if(markdowns[i].innerHTML) markdowns[i].innerHTML =marked(markdowns[i].innerHTML);
    }
  }
  window.addEventListener('DOMContentLoaded', Highlighting, false);
  window.addEventListener('load', Highlighting, false);
   var opt = {
       type: "github",
       user: "zjuchenyuan",
       repo: "notebook",
       no_comment: "No comments yet. Press the button and go to comment now!",
       go_to_comment: "Go to comment",
       issue_id: "1",
       btn_class: "btn",
       comments_target: "#comment-thread",
       loading_target: "#loading-spin",
       client_id: "8f7a792630aa459d0812",
       client_secret: "084b314f30dd9b10201011e265c4cb5d78c2b2e9"
   };
   if (jQuery('.discussion-timeline').length == 0) getComments(opt);
</script>
<script data-no-instant>
  InstantClick.init();
</script>
</html>
